@if(isReady) {
<div class="output-cvs-validation-modal">
    <div class="container-fluid">
        <div class="row">
            <div class="col-12">
                <h3>{{'CVS-VALIDATION-RESULT.TITOLO' | translate}}</h3>

                <div class="messages-box" #messages></div>

                @if(config?.errorMessage == null) {
                <!-- Informazioni generali -->
                <div>
                    <p *ngIf="showDetails">
                        {{'CVS-VALIDATION-RESULT.CONTROLLI-EFFETTUATI' | translate}} <span
                            class="highlighted-values fired-rules">{{config?.content?.cvsResult?.totalFiredRules}}</span>
                    </p>
                    <p>
                        {{'CVS-VALIDATION-RESULT.CONTROLLI-FALLITI' | translate}} <span
                            class="highlighted-values failed-assert">{{config?.content?.cvsResult?.totalFailedAsserts}}</span>
                    </p>
                </div>

                <!-- Table -->
                <p-table [value]="cvsItems" [tableStyle]="{ 'min-width': '30rem', 'font-size': '0.8rem' }"
                    class="small-font-table" [showCurrentPageReport]="true" [paginator]="true" [rows]="20"
                    [rowsPerPageOptions]="[20, 40, 60]" paginatorPosition="top"
                    currentPageReportTemplate="Visualizzate da {first} a {last} di {totalRecords} righe"
                    [scrollable]="true">
                    <ng-template pTemplate="header">
                        <tr>
                            <th scope="col">Numero</th>
                            <th scope="col">ID</th>
                            <th *ngIf="showDetails" scope="col">Sezione XML</th>
                            <th scope="col">Numero Lotto o Gruppo di lotti</th>
                            <th *ngIf="showDetails" scope="col">Regola di validazione</th>
                            <th scope="col">Tipo</th>
                            <th scope="col">Descrizione</th>
                            <th scope="col">Legenda dei termini utilizzati (BT-, OPT-, OPP-,
                                OPA-, GR-, ND-, ...)</th>
                            <th scope="col">Naviga all'errore</th>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="body" let-item>
                        <tr>
                            @if(item.index.includes('OK')) {
                            <td><span class="highlighted-values fired-rules">{{ item.index }}</span></td>
                            } @else {
                            <td><span class="highlighted-values failed-assert">{{ item.index }}</span></td>
                            }
                            <td>{{ item.id }}</td>
                            <td *ngIf="showDetails">{{ item.location }}</td>
                            <td>{{ recuperaIdentificativoLotto(item.numeroLotto) }}</td>
                            <td *ngIf="showDetails">{{ item.test }}</td>
                            <td>{{ mapRoleString(item.role) }}</td>
                            <td>{{ item.text }}</td>
                            <td>{{ item.legenda }}</td>
                            <td>@if(item.formControl != null){
                                <button class="p-ripple p-element p-button p-component navigate-error" tabindex="0"
                                    role="button" (click)="goToError(item.formControl, item.finalTarget)">
                                    <i class="mgg-icons-paginator-next"></i>
                                </button>
                                }
                            </td>
                        </tr>
                    </ng-template>
                    <ng-template pTemplate="emptymessage">
                        <tr>
                            <td colspan="5">{{ 'noRecords' | translate }}</td>
                        </tr>
                    </ng-template>
                </p-table>

                <!-- Pulsantiera -->
                <div class="buttons-row">
                    <sdk-button-group [config]="buttonsSubj" (output)="onButtonClick($event)"></sdk-button-group>
                </div>
                }
                @else {
                <div>
                    <p>
                        ID tracciatura: {{config?.idTracciatura}}
                    </p>
                </div>
                }
            </div>
        </div>
    </div>
</div>
}